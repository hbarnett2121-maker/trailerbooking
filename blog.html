<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Blog - Trailer Booking</title>
  <meta name="color-scheme" content="light">
  <style>
    :root{
      --green:#06F713; --ink:#111; --muted:#6b7280; --border:#e5e7eb; --bg:#ffffff;
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:#f8fafc;color:var(--ink);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased}

    .wrap{max-width:980px;margin:0 auto;padding:clamp(16px,4vw,24px); padding-bottom:48px;}
    h1{margin:16px 0 20px;font-size:clamp(24px,6vw,32px);text-align:center}
    h2{margin:16px 0 16px;font-size:clamp(20px,4vw,24px)}

    .card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);
      box-shadow:0 6px 24px rgba(0,0,0,.06);padding:clamp(16px,4vw,24px);margin:16px 0}

    .btn{min-height:52px;border:1px solid var(--border);padding:14px 24px;border-radius:12px;
      background:#fff;cursor:pointer;font-size:16px;width:100%;transition:all 0.2s;
      touch-action:manipulation;-webkit-tap-highlight-color:transparent}
    .btn.primary{background:var(--green);font-weight:700;border-color:var(--green)}
    .btn.primary:hover{opacity:0.9}
    .btn.primary:active{transform:scale(0.98)}
    .btn.secondary{background:#f3f4f6;border-color:var(--border);margin-top:12px}
    .btn.secondary:hover{background:#e5e7eb}
    .btn.small{min-height:40px;padding:8px 16px;font-size:14px;width:auto}
    .btn:disabled{opacity:.5;cursor:not-allowed}

    .form-group{margin-bottom:24px}
    .form-label{display:block;margin-bottom:10px;font-weight:600;font-size:16px}
    .form-input, .form-textarea{width:100%;padding:14px;border:1px solid var(--border);
      border-radius:10px;font-size:16px;font-family:inherit;transition:border-color 0.2s;
      -webkit-appearance:none;appearance:none}
    .form-input:focus, .form-textarea:focus{outline:none;border-color:var(--green);
      box-shadow:0 0 0 3px rgba(6,247,19,.1)}
    .form-textarea{min-height:200px;resize:vertical;line-height:1.6}

    /* Blog Post Styles */
    .blog-post{padding:24px;border-bottom:1px solid var(--border);margin-bottom:20px;
      transition:background 0.2s}
    .blog-post:last-child{border-bottom:none;margin-bottom:0}
    .blog-post:hover{background:#fafafa}

    .post-header{margin-bottom:16px}
    .post-title{font-size:clamp(20px,4vw,26px);font-weight:700;margin:0 0 8px 0;
      color:var(--ink);line-height:1.3}
    .post-meta{display:flex;gap:16px;flex-wrap:wrap;align-items:center;
      font-size:14px;color:var(--muted);margin-bottom:12px}
    .post-author{font-weight:600}
    .post-date{display:flex;align-items:center;gap:4px}
    .post-content{color:var(--ink);line-height:1.8;font-size:16px;
      word-wrap:break-word;white-space:pre-wrap}

    .post-actions{display:flex;gap:8px;margin-top:16px;padding-top:16px;
      border-top:1px solid var(--border)}

    .success-msg{background:#d1fae5;border:1px solid #10b981;color:#065f46;
      padding:16px;border-radius:10px;margin:16px 0;text-align:center;font-size:15px}
    .error-msg{background:#fee2e2;border:1px solid #ef4444;color:#991b1b;
      padding:16px;border-radius:10px;margin:16px 0;text-align:center;font-size:15px}

    .empty-state{text-align:center;padding:60px 20px;color:var(--muted)}
    .empty-state-icon{font-size:64px;margin-bottom:16px;opacity:0.3}
    .empty-state p{font-size:16px;margin:0}

    .stats{display:flex;gap:clamp(16px,4vw,32px);margin:16px 0;flex-wrap:wrap;
      justify-content:center}
    .stat{text-align:center;flex:1;min-width:120px}
    .stat-value{font-size:clamp(28px,8vw,36px);font-weight:700;color:var(--green)}
    .stat-label{font-size:14px;color:var(--muted);margin-top:4px}

    .toggle-form{text-align:center;margin:16px 0}

    .hidden{display:none}

    /* Mobile Optimizations */
    @media (max-width: 640px) {
      .wrap{padding:12px;padding-bottom:32px}
      .card{padding:16px;margin:12px 0}
      h1{margin:12px 0 16px;font-size:26px}
      h2{font-size:20px;margin:12px 0}
      .form-group{margin-bottom:20px}
      .blog-post{padding:16px}
      .post-title{font-size:20px}
      .post-content{font-size:15px}
      .post-actions{flex-direction:column}
      .btn.small{width:100%}
      .stats{gap:12px}
      .stat{min-width:100px}
    }

    @media (max-width: 380px) {
      .stats{flex-direction:column;gap:16px}
      .stat{min-width:auto}
      .post-meta{flex-direction:column;gap:4px;align-items:flex-start}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>üìù Blog</h1>

    <!-- Statistics Section -->
    <div class="card">
      <div class="stats">
        <div class="stat">
          <div class="stat-value" id="totalPosts">0</div>
          <div class="stat-label">Total Posts</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="totalAuthors">0</div>
          <div class="stat-label">Authors</div>
        </div>
      </div>
    </div>

    <!-- Toggle Create Post Button -->
    <div class="toggle-form">
      <button class="btn primary" id="toggleFormBtn" onclick="togglePostForm()">
        ‚úçÔ∏è Write New Post
      </button>
    </div>

    <!-- Create Post Section -->
    <div class="card hidden" id="postFormCard">
      <h2>Create New Post</h2>
      <form id="postForm">
        <div class="form-group">
          <label class="form-label" for="postTitle">Post Title *</label>
          <input type="text" id="postTitle" name="title" class="form-input"
                 placeholder="Enter your post title..." required>
        </div>

        <div class="form-group">
          <label class="form-label" for="postAuthor">Author Name *</label>
          <input type="text" id="postAuthor" name="author" class="form-input"
                 placeholder="Your name..." required>
        </div>

        <div class="form-group">
          <label class="form-label" for="postContent">Post Content *</label>
          <textarea id="postContent" name="content" class="form-textarea"
                    placeholder="Write your blog post here..." required></textarea>
        </div>

        <button type="submit" class="btn primary" id="submitBtn">Publish Post</button>
        <button type="button" class="btn secondary" onclick="togglePostForm()">Cancel</button>
      </form>

      <div id="message"></div>
    </div>

    <!-- Blog Posts Display Section -->
    <div class="card">
      <h2>Recent Posts</h2>
      <div id="postsList">
        <div class="empty-state">
          <div class="empty-state-icon">üì∞</div>
          <p>No blog posts yet. Be the first to write!</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // LocalStorage key for blog posts
    const STORAGE_KEY = 'trailerBookingBlogPosts';

    // Toggle post form visibility
    function togglePostForm() {
      const formCard = document.getElementById('postFormCard');
      const toggleBtn = document.getElementById('toggleFormBtn');

      if (formCard.classList.contains('hidden')) {
        formCard.classList.remove('hidden');
        toggleBtn.textContent = '‚ùå Cancel';
        formCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      } else {
        formCard.classList.add('hidden');
        toggleBtn.textContent = '‚úçÔ∏è Write New Post';
        document.getElementById('postForm').reset();
        hideMessage();
      }
    }

    // Get posts from localStorage
    function getPosts() {
      try {
        const posts = localStorage.getItem(STORAGE_KEY);
        return posts ? JSON.parse(posts) : [];
      } catch (error) {
        console.error('Error reading posts:', error);
        return [];
      }
    }

    // Save posts to localStorage
    function savePosts(posts) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(posts));
        return true;
      } catch (error) {
        console.error('Error saving posts:', error);
        showMessage('Failed to save post. Storage may be full.', 'error');
        return false;
      }
    }

    // Form Submission
    document.getElementById('postForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const postData = {
        id: Date.now().toString(),
        title: document.getElementById('postTitle').value.trim(),
        author: document.getElementById('postAuthor').value.trim(),
        content: document.getElementById('postContent').value.trim(),
        timestamp: new Date().toISOString()
      };

      // Get existing posts
      const posts = getPosts();

      // Add new post to beginning
      posts.unshift(postData);

      // Save to localStorage
      if (savePosts(posts)) {
        showMessage('Post published successfully!', 'success');
        document.getElementById('postForm').reset();

        // Reload posts display
        loadPosts();

        // Hide form after short delay
        setTimeout(() => {
          togglePostForm();
        }, 1500);
      }
    });

    // Delete post
    function deletePost(postId) {
      if (confirm('Are you sure you want to delete this post?')) {
        let posts = getPosts();
        posts = posts.filter(post => post.id !== postId);

        if (savePosts(posts)) {
          showMessage('Post deleted successfully.', 'success');
          loadPosts();
          setTimeout(hideMessage, 2000);
        }
      }
    }

    // Edit post
    function editPost(postId) {
      const posts = getPosts();
      const post = posts.find(p => p.id === postId);

      if (post) {
        // Show form
        if (document.getElementById('postFormCard').classList.contains('hidden')) {
          togglePostForm();
        }

        // Fill form with post data
        document.getElementById('postTitle').value = post.title;
        document.getElementById('postAuthor').value = post.author;
        document.getElementById('postContent').value = post.content;

        // Delete old post (will be replaced with edited version)
        deletePost(postId);

        // Scroll to form
        document.getElementById('postFormCard').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // Load and Display Posts
    function loadPosts() {
      const posts = getPosts();
      displayPosts(posts);
      updateStats(posts);
    }

    function displayPosts(posts) {
      const postsList = document.getElementById('postsList');

      if (posts.length === 0) {
        postsList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üì∞</div>
            <p>No blog posts yet. Be the first to write!</p>
          </div>
        `;
        return;
      }

      postsList.innerHTML = posts.map(post => `
        <article class="blog-post">
          <div class="post-header">
            <h3 class="post-title">${escapeHtml(post.title)}</h3>
            <div class="post-meta">
              <span class="post-author">üë§ ${escapeHtml(post.author)}</span>
              <span class="post-date">üìÖ ${formatDate(post.timestamp)}</span>
            </div>
          </div>
          <div class="post-content">${escapeHtml(post.content)}</div>
          <div class="post-actions">
            <button class="btn small secondary" onclick="editPost('${post.id}')">‚úèÔ∏è Edit</button>
            <button class="btn small secondary" onclick="deletePost('${post.id}')">üóëÔ∏è Delete</button>
          </div>
        </article>
      `).join('');
    }

    function updateStats(posts) {
      const totalPosts = posts.length;
      document.getElementById('totalPosts').textContent = totalPosts;

      // Count unique authors
      const uniqueAuthors = new Set(posts.map(p => p.author.toLowerCase()));
      document.getElementById('totalAuthors').textContent = uniqueAuthors.size;
    }

    function formatDate(timestamp) {
      const date = new Date(timestamp);
      const options = {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      };
      return date.toLocaleDateString('en-US', options);
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function showMessage(text, type) {
      const messageDiv = document.getElementById('message');
      messageDiv.className = type === 'success' ? 'success-msg' : 'error-msg';
      messageDiv.textContent = text;
      messageDiv.style.display = 'block';
    }

    function hideMessage() {
      const messageDiv = document.getElementById('message');
      messageDiv.style.display = 'none';
    }

    // Load posts on page load
    loadPosts();
  </script>
</body>
</html>
